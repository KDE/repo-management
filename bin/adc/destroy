#!/bin/sh

. $(dirname $0)/adc.common-functions

delete=$1

get_rights_and_owner $delete

# please choose one alternative and delete the other para

# alternative 1 -- only creator can delete
[ "$owner" = "$GL_USER" ] || die "$delete is not yours to delete!"

echo "Destroying repository $delete..."

cd $GL_REPO_BASE_ABS
rm -rf $delete.git

cd $HOME
PROJECTS_LIST=$(perl -e 'do ".gitolite.rc"; print $PROJECTS_LIST')
perl -ni -e "print unless /^$delete$/" $PROJECTS_LIST

echo "Done"
